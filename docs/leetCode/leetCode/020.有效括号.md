---
sidebar: auto
---

# 20.有效的括号
## [题目描述](https://leetcode.cn/problems/valid-parentheses/)

::: tip
标签：栈、字符串
:::

给定一个只包括 `'('，')'，'{'，'}'，'['，']'` 的字符串s ，判断字符串是否有效。

有效字符串需满足：

- 左括号必须用相同类型的右括号闭合。
- 左括号必须以正确的顺序闭合。
- 每个右括号都有一个对应的相同类型的左括号。
 

示例 1：
```
输入：s = "()"
输出：true
```

示例 2：
```
输入：s = "()[]{}"
输出：true
```

示例 3：
```
输入：s = "(]"
输出：false
```

## 算法思路

方法一：栈

判断括号的有效性可以使用「栈」这一数据结构来解决。

我们遍历给定的字符串`s`。当我们遇到一个「左括号」时，我们会期望在后续的遍历中，有一个相同类型的「右括号」将其闭合。由于后面遇到的「左括号」要先闭合，因此我们可以将这个左括号放入栈顶。

当我们遇到一个右括号时，我们需要将一个相同类型的左括号闭合。此时，我们可以取出栈顶的左括号并判断它们是否是相同类型的括号。如果不是相同的类型，或者栈中并没有左括号，那么字符串`s`无效，返回 false。为了快速判断括号的类型，我们可以使用哈希表存储每一种括号。**哈希表的键为右括号，值为相同类型的左括号。**

在遍历结束后，如果栈中没有左括号，说明我们将字符串s 中的所有左括号闭合，返回 true 否则返回 false

注意到有效字符串的长度一定为偶数，因此如果字符串的长度为奇数，我们可以直接返回 false 省去后续的遍历判断过程。

```js
var isValid = function(s) {
  // 取出字符串的长度
  const n = s.length;
  // 如果字符串的长度是奇数，直接返回 false
  if (n % 2 === 1) {
    return false;
  }
  // map 存入了一个二维数组
  const pairs = new Map([
    [')', '('],
    [']', '['],
    ['}', '{']
  ]);
  // 使用一个栈存储
  const stk = [];

  for (let ch of s){
    if (pairs.has(ch)) { // 判断当前字符是否为右括号
      // 如果栈为空或栈顶元素不是与当前右括号匹配的左括号
      if (stk.length === 0 || stk[stk.length - 1] !== pairs.get(ch)) {
        return false;
      }
      // 栈顶元素与当前右括号匹配，将栈顶元素出栈
      stk.pop();
    } else {
      // 当前字符是左括号，将其压入栈中
      stk.push(ch);
    }
  };

  // 遍历结束后，如果栈为空，则表示所有括号都正确匹配，返回 true；否则，返回 false
  return !stk.length;
};
```

```ts
function isValid(s: string): boolean {
  // 取出字符串的长度
  const n: number = s.length;
  // 如果字符串的长度是奇数，直接返回 false
  if (n % 2 === 1) {
    return false;
  }
  // map 存入了一个二维数组
  const pairs: Map<string, string> = new Map([
    [')', '('],
    [']', '['],
    ['}', '{']
  ]);
  // 使用一个栈存储
  const stk: string[] = [];
  for (let ch of s){
    if (pairs.has(ch)) {
      if (!stk.length || stk[stk.length - 1] !== pairs.get(ch)) {
        return false;
      }
      stk.pop();
    } else {
      stk.push(ch);
    }
  };
  return stk.length === 0;
};
```

这段代码实现了一个函数 `isValid`，用于检查给定的字符串中的括号是否合法。它遵循以下步骤：

1. 首先，获取字符串的长度，并判断长度是否为奇数，如果是，则直接返回 false，因为在有效的括号序列中，左右括号的数量必须相等，所以如果字符串长度为奇数，一定存在无法匹配的情况。
2. 创建一个 `pairs` 的 Map 对象，其中存储了三种右括号和对应的左括号的映射关系。
3. 创建一个空栈 `stk` 用于存储左括号。
4. 遍历输入字符串 `s` 中的每个字符 `ch`：
   - 如果 `ch` 是右括号，即 `pairs` 中存在对应的映射关系：
     - 检查栈是否为空或栈顶元素与当前右括号的映射不匹配，若是，则表示存在不匹配的情况，返回 false。
     - 若匹配成功，则将栈顶元素出栈。
   - 如果 `ch` 是左括号，将其压入栈中。
5. 遍历结束后，如果栈为空，则表示所有括号都正确匹配，返回 true；否则，返回 false。

这段代码利用栈的特性来判断括号的匹配情况，对输入字符串进行一次遍历即可判断括号序列是否合法。


## 复杂度分析

时间复杂度：O(n)
- 其中，n 是输入字符串的长度。
- 遍历字符串的时间复杂度为 O(n)。
- 在遍历过程中，对于每个字符，执行的操作都是常数时间复杂度的。

空间复杂度：O(n)
- 使用了一个栈 `stk` 来存储左括号。
- 栈的最大长度不会超过输入字符串的长度 n。
- 因此，栈的空间复杂度为 O(n)。