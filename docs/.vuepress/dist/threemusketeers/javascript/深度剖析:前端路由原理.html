<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深度剖析 前端路由原理 | 褚鹏飞的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="终于等到你">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.589cdd6a.js" as="script"><link rel="preload" href="/assets/js/2.4af8b881.js" as="script"><link rel="preload" href="/assets/js/98.dae17025.js" as="script"><link rel="prefetch" href="/assets/js/10.0c27a9b4.js"><link rel="prefetch" href="/assets/js/100.36841e54.js"><link rel="prefetch" href="/assets/js/101.8f69454f.js"><link rel="prefetch" href="/assets/js/102.996013f3.js"><link rel="prefetch" href="/assets/js/103.5c902afd.js"><link rel="prefetch" href="/assets/js/104.afb536b3.js"><link rel="prefetch" href="/assets/js/11.db22200b.js"><link rel="prefetch" href="/assets/js/12.0d268341.js"><link rel="prefetch" href="/assets/js/13.be121c07.js"><link rel="prefetch" href="/assets/js/14.a8b36e52.js"><link rel="prefetch" href="/assets/js/15.dbdae71a.js"><link rel="prefetch" href="/assets/js/16.3dd90040.js"><link rel="prefetch" href="/assets/js/17.4dfc44c7.js"><link rel="prefetch" href="/assets/js/18.7afb642c.js"><link rel="prefetch" href="/assets/js/19.738132af.js"><link rel="prefetch" href="/assets/js/20.3b8335ab.js"><link rel="prefetch" href="/assets/js/21.221ff5f6.js"><link rel="prefetch" href="/assets/js/22.66001863.js"><link rel="prefetch" href="/assets/js/23.e9d87f34.js"><link rel="prefetch" href="/assets/js/24.277f4511.js"><link rel="prefetch" href="/assets/js/25.c817c64d.js"><link rel="prefetch" href="/assets/js/26.c1db00ac.js"><link rel="prefetch" href="/assets/js/27.35f0671b.js"><link rel="prefetch" href="/assets/js/28.30d96535.js"><link rel="prefetch" href="/assets/js/29.20277374.js"><link rel="prefetch" href="/assets/js/3.af950ec1.js"><link rel="prefetch" href="/assets/js/30.20675a53.js"><link rel="prefetch" href="/assets/js/31.1f1100c8.js"><link rel="prefetch" href="/assets/js/32.0e5a1c6d.js"><link rel="prefetch" href="/assets/js/33.8b6a11fd.js"><link rel="prefetch" href="/assets/js/34.26db0bd9.js"><link rel="prefetch" href="/assets/js/35.2290c2f0.js"><link rel="prefetch" href="/assets/js/36.c774b8f6.js"><link rel="prefetch" href="/assets/js/37.e3e74cd1.js"><link rel="prefetch" href="/assets/js/38.8356502a.js"><link rel="prefetch" href="/assets/js/39.f66c4f18.js"><link rel="prefetch" href="/assets/js/4.a78b8090.js"><link rel="prefetch" href="/assets/js/40.2acdee24.js"><link rel="prefetch" href="/assets/js/41.912582f1.js"><link rel="prefetch" href="/assets/js/42.a9751665.js"><link rel="prefetch" href="/assets/js/43.e255bbdb.js"><link rel="prefetch" href="/assets/js/44.397f285e.js"><link rel="prefetch" href="/assets/js/45.e4eb0d4a.js"><link rel="prefetch" href="/assets/js/46.d105ff94.js"><link rel="prefetch" href="/assets/js/47.91e50944.js"><link rel="prefetch" href="/assets/js/48.03745317.js"><link rel="prefetch" href="/assets/js/49.692f6bcd.js"><link rel="prefetch" href="/assets/js/5.3da002ce.js"><link rel="prefetch" href="/assets/js/50.b14024fe.js"><link rel="prefetch" href="/assets/js/51.53c3e591.js"><link rel="prefetch" href="/assets/js/52.65ca864f.js"><link rel="prefetch" href="/assets/js/53.341cc336.js"><link rel="prefetch" href="/assets/js/54.d86c6361.js"><link rel="prefetch" href="/assets/js/55.e6a509aa.js"><link rel="prefetch" href="/assets/js/56.7cc6f6b2.js"><link rel="prefetch" href="/assets/js/57.a835894f.js"><link rel="prefetch" href="/assets/js/58.e25e4e32.js"><link rel="prefetch" href="/assets/js/59.b9d216f2.js"><link rel="prefetch" href="/assets/js/6.6c9ad43a.js"><link rel="prefetch" href="/assets/js/60.14c78330.js"><link rel="prefetch" href="/assets/js/61.3d904ca0.js"><link rel="prefetch" href="/assets/js/62.ea9187f2.js"><link rel="prefetch" href="/assets/js/63.ebc7947d.js"><link rel="prefetch" href="/assets/js/64.45416a34.js"><link rel="prefetch" href="/assets/js/65.e53af7c7.js"><link rel="prefetch" href="/assets/js/66.47c3a609.js"><link rel="prefetch" href="/assets/js/67.2ceb2070.js"><link rel="prefetch" href="/assets/js/68.8dc863d7.js"><link rel="prefetch" href="/assets/js/69.c8619253.js"><link rel="prefetch" href="/assets/js/7.200d2f91.js"><link rel="prefetch" href="/assets/js/70.24b00713.js"><link rel="prefetch" href="/assets/js/71.d46b9e48.js"><link rel="prefetch" href="/assets/js/72.1cc27870.js"><link rel="prefetch" href="/assets/js/73.10771ffb.js"><link rel="prefetch" href="/assets/js/74.6b9af13d.js"><link rel="prefetch" href="/assets/js/75.fb5a8c7a.js"><link rel="prefetch" href="/assets/js/76.11bb0c52.js"><link rel="prefetch" href="/assets/js/77.79b98fb4.js"><link rel="prefetch" href="/assets/js/78.e2037dfa.js"><link rel="prefetch" href="/assets/js/79.3f9cc615.js"><link rel="prefetch" href="/assets/js/8.b00ce60c.js"><link rel="prefetch" href="/assets/js/80.defac35a.js"><link rel="prefetch" href="/assets/js/81.b0131921.js"><link rel="prefetch" href="/assets/js/82.bf5d27db.js"><link rel="prefetch" href="/assets/js/83.164b49c9.js"><link rel="prefetch" href="/assets/js/84.4b8cf64b.js"><link rel="prefetch" href="/assets/js/85.824e2ff2.js"><link rel="prefetch" href="/assets/js/86.5d5161c5.js"><link rel="prefetch" href="/assets/js/87.fd60ba2a.js"><link rel="prefetch" href="/assets/js/88.5560d0bf.js"><link rel="prefetch" href="/assets/js/89.2eafd629.js"><link rel="prefetch" href="/assets/js/9.cc81d235.js"><link rel="prefetch" href="/assets/js/90.e58e81ee.js"><link rel="prefetch" href="/assets/js/91.c20beee5.js"><link rel="prefetch" href="/assets/js/92.a00d1f14.js"><link rel="prefetch" href="/assets/js/93.bde5a7e4.js"><link rel="prefetch" href="/assets/js/94.adaef5e3.js"><link rel="prefetch" href="/assets/js/95.1650662c.js"><link rel="prefetch" href="/assets/js/96.e7d0ebd9.js"><link rel="prefetch" href="/assets/js/97.26e2f42a.js"><link rel="prefetch" href="/assets/js/99.3764ca9d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">褚鹏飞的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  常用算法
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/leetCode/" class="nav-link">
  leetCode算题解
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/niuke/" class="nav-link">
  牛客算题解
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/valuableBook/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/offer/" class="nav-link">
  剑指offer
</a></li></ul></div></div><div class="nav-item"><a href="/dataStructure/" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue-analysis/" class="nav-link">
  Vue2内部原理剖析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3-analysis/" class="nav-link">
  Vue3内部原理剖析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue-component/" class="nav-link">
  Vue组件探索
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  Vuex源码解析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue-router/" class="nav-link">
  Vue-Router源码解析
</a></li></ul></div></div><div class="nav-item"><a href="/react/" class="nav-link">
  React
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webpack" class="dropdown-title"><span class="title">webpack</span> <span class="arrow down"></span></button> <button type="button" aria-label="webpack" class="mobile-dropdown-title"><span class="title">webpack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/webpack-base.html" class="nav-link">
  webpack基础
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-advance.html" class="nav-link">
  webpack进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node.js" class="dropdown-title"><span class="title">Node.js</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node.js" class="mobile-dropdown-title"><span class="title">Node.js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/node-base/" class="nav-link">
  Node基础
</a></li><li class="dropdown-item"><!----> <a href="/node/express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/node/koa/" class="nav-link">
  Koa
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端" class="mobile-dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">
  git工具
</a></li><li class="dropdown-item"><!----> <a href="/nginx/nginx-base/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">
  kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/database/mysql/" class="nav-link">
  mySql
</a></li><li class="dropdown-item"><!----> <a href="/database/mongodb/" class="nav-link">
  mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><span class="title">前端三剑客</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端三剑客" class="mobile-dropdown-title"><span class="title">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/threemusketeers/javascript/" class="nav-link router-link-active">
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/threemusketeers/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/threemusketeers/css/" class="nav-link">
  css
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  常用算法
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/leetCode/" class="nav-link">
  leetCode算题解
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/niuke/" class="nav-link">
  牛客算题解
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/valuableBook/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/leetCode/offer/" class="nav-link">
  剑指offer
</a></li></ul></div></div><div class="nav-item"><a href="/dataStructure/" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue-analysis/" class="nav-link">
  Vue2内部原理剖析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3-analysis/" class="nav-link">
  Vue3内部原理剖析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue-component/" class="nav-link">
  Vue组件探索
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  Vuex源码解析
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue-router/" class="nav-link">
  Vue-Router源码解析
</a></li></ul></div></div><div class="nav-item"><a href="/react/" class="nav-link">
  React
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webpack" class="dropdown-title"><span class="title">webpack</span> <span class="arrow down"></span></button> <button type="button" aria-label="webpack" class="mobile-dropdown-title"><span class="title">webpack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/webpack-base.html" class="nav-link">
  webpack基础
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-advance.html" class="nav-link">
  webpack进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node.js" class="dropdown-title"><span class="title">Node.js</span> <span class="arrow down"></span></button> <button type="button" aria-label="Node.js" class="mobile-dropdown-title"><span class="title">Node.js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/node-base/" class="nav-link">
  Node基础
</a></li><li class="dropdown-item"><!----> <a href="/node/express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/node/koa/" class="nav-link">
  Koa
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端" class="mobile-dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">
  git工具
</a></li><li class="dropdown-item"><!----> <a href="/nginx/nginx-base/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">
  kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/database/mysql/" class="nav-link">
  mySql
</a></li><li class="dropdown-item"><!----> <a href="/database/mongodb/" class="nav-link">
  mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><span class="title">前端三剑客</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端三剑客" class="mobile-dropdown-title"><span class="title">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/threemusketeers/javascript/" class="nav-link router-link-active">
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/threemusketeers/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/threemusketeers/css/" class="nav-link">
  css
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>深度剖析 前端路由原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#深度剖析-前端路由原理-2" class="sidebar-link">深度剖析 前端路由原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#什么是路由" class="sidebar-link">什么是路由</a></li><li class="sidebar-sub-header"><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#前端路由的核心问题" class="sidebar-link">前端路由的核心问题</a></li><li class="sidebar-sub-header"><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#前端路由的两种实现" class="sidebar-link">前端路由的两种实现</a></li><li class="sidebar-sub-header"><a href="/threemusketeers/javascript/%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90:%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="深度剖析-前端路由原理"><a href="#深度剖析-前端路由原理" class="header-anchor">#</a> 深度剖析 前端路由原理</h1> <h2 id="深度剖析-前端路由原理-2"><a href="#深度剖析-前端路由原理-2" class="header-anchor">#</a> 深度剖析 前端路由原理</h2> <h3 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h3> <p>前端三大框架 <code>Angular、React、Vue</code> 他们都有自己的路由方案，都是基于前端路由原理进行封装实现的，我们在实际项目开发中会遇到一些坑，弄明白其中的实现原理才能在开发中游刃有余。</p> <h3 id="什么是路由"><a href="#什么是路由" class="header-anchor">#</a> 什么是路由</h3> <p>路由的概念起源于服务端，在以前前后端没有分离的时候，由后端来控制路由，当接收到客户端发来的<code>HTTP</code>请求，就会根据所请求的<code>URL</code>,来查找对应的映射函数，然后执行该函数，并将函数的返回值发送给客户端。</p> <p>对于最简单的静态资源服务器，可以认为，所有的<code>URL</code>的映射函数就是一个文件读取操作，对于动态资源，映射函数可能是一个数据库读取操作，也可能是进行一些数据的处理等等，然后根据这些数据渲染模板，再将渲染好的页面返回。</p> <p>这样处理的缺点和有优点都很明显：</p> <ul><li>好处：安全性好、SEO好；</li> <li>缺点：加大了服务器的压力，不利于用户体验，代码比较冗余不好维护</li></ul> <p>因为服务端路由有自己的局限性，前端路由才能找到了自己的发挥空间，对于前端路由来说，路由的映射函数，通常是一些DOM的显示和隐藏操作，这样，当访问不同的路径的时候，会显示不同的页面组件，在现在的单页面应用中，<strong>前端路由</strong>描述的URL和UI之间的单向映射关系，即URL变化引起的UI页面的更新。</p> <h3 id="前端路由的核心问题"><a href="#前端路由的核心问题" class="header-anchor">#</a> 前端路由的核心问题</h3> <ul><li>如何检测到URL的变化？</li> <li>如何改变URL却不引起页面的刷新？</li></ul> <p>前端路由主要有以下两种实现方案:</p> <ul><li>1、Hash</li> <li>2、History</li></ul> <blockquote><p>在<code>Hash</code>方式中，我们可以通过<code>hashchange</code>事件监听URL的变化，以下的场景会触发<code>hashchange</code>事件：通过浏览器前进后退改变URL、通过标签改变URL、通过<code>window.location</code>改变URL Hash 是 URL中 # 以及后面的部分，改变URL中的hash部分不会引起页面的刷新。</p></blockquote> <blockquote><p>在<code>History</code>方式中，我们可以通过<code>popstate</code>事件监听 URL的变化, 我们可以调用<code>pushState</code>和<code>replaceState</code>两个方法，改变URL而不引起页面的刷新,值得注意的是，通过浏览器前进后退改变时候回触发<code>popState</code>事件，而通过<code>pushState、replaceState</code>或标签改变 URL 并不会触发<code>popstate</code>事件，因此我们需要手动拦截监听。</p></blockquote> <p>当然，前端路由也存在缺陷：使用浏览器的前进、后退的时候重新发送了请求，重新获取数据，没有合理的利用缓存，但是总的来说，现在前端路由已经是实现路由的主要方式了，前端三大框架 <code>Angular、React、Vue</code>，它们的路由解决方案 <code>angular/router、react-router、vue-router</code>都是基于前端路由进行开发的，因此将前端路由进行了解和掌握是很有必要的，下面我们分别对两种常见的前端路由模式 Hash 和 History 进行讲解。</p> <h3 id="前端路由的两种实现"><a href="#前端路由的两种实现" class="header-anchor">#</a> 前端路由的两种实现</h3> <h4 id="hash-模式"><a href="#hash-模式" class="header-anchor">#</a> Hash 模式</h4> <h5 id="实现原理"><a href="#实现原理" class="header-anchor">#</a> 实现原理</h5> <p>早期的前端路由实现就是基于<code>location.hash</code>来实现的，其实现原理也很简单。<code>location.hash</code>的值就是url中  # 后面的内容，比如这个网址，它的<code>location.hash</code>的值为 '#/search'</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>word<span class="token punctuation">.</span>com#search
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此外，hash也存在下面几个特性</p> <ul><li>URL中hash值只是客户端的一种状态，也就是说当向服务器发出请求的时候，hash部分不会被发送。</li> <li>hash值的改变，都会在浏览器的访问历史中添加一个记录，因此我们能够通过浏览器的回退、前进控制hash的切换</li> <li>我们可以使用hashChange来监听hash的变化</li></ul> <h5 id="两种方式触发hash"><a href="#两种方式触发hash" class="header-anchor">#</a> 两种方式触发hash</h5> <p>a标签：
通过a标签设置 href属性，当用户点击这个标签后，URL就会发生改变，也就会触发 <code>hashchange</code> 事件了;</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#search&quot;</span><span class="token operator">&gt;</span>search<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>js控制实现:</p> <p>另外一种就是js控制实现，从而改变URL</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>location<span class="token punctuation">.</span>hash<span class="token operator">=</span><span class="token string">&quot;#search&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="js实现"><a href="#js实现" class="header-anchor">#</a> js实现</h4> <p>我们先定义一个父类 BaseRouter，用于实现 Hash路由和 History 一些公共方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BaseRouter</span> <span class="token punctuation">{</span>
  <span class="token comment">// list 表示路由表</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> list
  <span class="token punctuation">}</span>
  <span class="token comment">// 页面渲染函数</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ele <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">ele</span> <span class="token operator">=&gt;</span> ele<span class="token punctuation">.</span>path <span class="token operator">===</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ele <span class="token operator">?</span> ele<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token parameter">ele</span> <span class="token operator">=&gt;</span> ele<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">ELEMENT</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> ele<span class="token punctuation">.</span>component<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>我们简单实现了 push 压入功能，go 前进后退功能</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HashRouter</span> <span class="token keyword">extends</span> <span class="token class-name">BaseRouter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 监听 hashchange 事件</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// hash改变的时候，重新渲染页面</span>
  <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取hash值</span>
  <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> hash <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">;</span>
    <span class="token keyword">return</span> hash <span class="token operator">?</span> hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token string">'/'</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// push 新的页面</span>
  <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> path<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取默认页面的url</span>
  <span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
    <span class="token keyword">const</span> i <span class="token operator">=</span> href<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> base <span class="token operator">=</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span> href<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token operator">:</span> href<span class="token punctuation">;</span>
    <span class="token keyword">return</span> base <span class="token operator">+</span> <span class="token string">'#'</span> <span class="token operator">+</span> path<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 替换页面</span>
  <span class="token function">replace</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 前进 or 后退浏览历史</span>
  <span class="token function">go</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h4 id="history-模式"><a href="#history-模式" class="header-anchor">#</a> History 模式</h4> <h5 id="实现原理-2"><a href="#实现原理-2" class="header-anchor">#</a> 实现原理</h5> <p>前面的hash 虽然也很不错，但是使用上都需要加上 # ，并不是很美观，因此到了HTML5 又提供了 History API 来实现URL变化。其中做最主要的api有两个:</p> <p>history.pushState() 和 history.replaceState() 这两个api可以在不进行刷新的状态下操作浏览器的历史记录，唯一不同的是，前者是新增加一个历史记录，后者是直接替换掉当前的历史记录。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">repalceState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此外，history 还存在几个特性:</p> <ul><li>pushState 和 replaceState 的标题（title）一般浏览器会忽略，最好传入null</li> <li>我们可以使用 popstate 事件来监听 url 变化</li> <li>history.pushState() 或者 history.repalceState() 不会触发 popstate 事件，这个时候我们应该手动触发页面渲染。</li></ul> <h4 id="js实现-2"><a href="#js实现-2" class="header-anchor">#</a> js实现</h4> <p>同样简单实现了push压入功能、 go 前进/后退功能</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HistoryRouter</span> <span class="token keyword">extends</span> <span class="token class-name">BaseRouter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 监听 popState 事件</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'触发 popstate。。。'</span><span class="token punctuation">)</span>；
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 渲染页面</span>
    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 获取url</span>
    <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> path <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">;</span>
      <span class="token keyword">return</span> path <span class="token operator">?</span> path <span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// push 页面</span>
    <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      history<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 前进 or 后退</span>
    <span class="token function">go</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>本文介绍了什么是路由，前端路由的起源，以及分析了两种前端路由： Hash模式和History模式原理以及简单的实现。
通过对于本文对前端路由的原理的掌握，这个时候就可以基于原理去阅读react-router和 vue-router的源码实现了。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.589cdd6a.js" defer></script><script src="/assets/js/2.4af8b881.js" defer></script><script src="/assets/js/98.dae17025.js" defer></script>
  </body>
</html>
